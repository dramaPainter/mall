!function () {
    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');
    var Commands = {
        register: function (editor) {
            editor.addCommand('beHeader', function () {});
        }
    };

    var Buttons = {
        register: function (editor) {
            editor.ui.registry.addButton('imageLibrary', {
                icon: 'image',
                tooltip: 'uploadImg', // 鼠标移到按钮上显示的文字提示
                onAction: function () {
                    uploadEvent(editor)
                }
            });
            editor.ui.registry.addMenuItem('imageLibrary', {
                icon: 'image',
                text: 'uploadImg',
                onAction: function () {
                    uploadEvent(editor)
                }
            });
        }
    };

    let uploadEvent = function (editor) {
        library.show(ENUM.upload.PRODUCT_CAROUSEL.value, urls => {
            urls.forEach(img => editor.execCommand("mceInsertContent", false, '<img class="articleImage" src="' + img.url + '"/>'));
        });
    }

    function imageLibraryPlugin() {
        global.add('imageLibrary', function (editor) {
            Commands.register(editor);
            Buttons.register(editor);
        });
    }

    imageLibraryPlugin();
}();
